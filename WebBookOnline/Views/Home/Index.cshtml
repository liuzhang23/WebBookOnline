

@model PagedList.IPagedList<WebBookOnline.Models.Book>
@using PagedList.Mvc
@{
    Layout = "~/Views/Shared/Layout.cshtml";
}

<script>
    var dropDouwnBlock = document.querySelector(".dropdown-menu");
    dropDouwnBlock.classList.add("d-lg-block")

</script>

<!-- Start slider section -->
<section class="p-2" id="Slider-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-3 ">
            </div>
            <div class="col-md-12 col-lg-6">
                <div class="row">
                    <div id="carouselExampleCaptions" class="carousel slide">
                        <div class="carousel-indicators">
                            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active"
                                    aria-current="true" aria-label="Slide 1"></button>
                            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1"
                                    aria-label="Slide 2"></button>
                            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2"
                                    aria-label="Slide 3"></button>
                        </div>
                        <div class="carousel-inner">
                            <div class="carousel-item active">
                                <img src="https://truyen.tangthuvien.vn/images/slide7.jpg" class="d-block w-100" alt="...">
                                <div class="carousel-caption d-none d-md-block">
                                    <h5>First slide label</h5>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <img src="https://truyen.tangthuvien.vn/images/slide9.jpg" class="d-block w-100" alt="...">
                                <div class="carousel-caption d-none d-md-block">
                                    <h5>Second slide label</h5>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <img src="https://truyen.tangthuvien.vn/images/slide8.jpg" class="d-block w-100" alt="...">
                                <div class="carousel-caption d-none d-md-block">
                                    <h5>Third slide label</h5>
                                </div>
                            </div>
                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                </div>
                <div class="row d-none d-sm-flex">
                    <div class="col-md-4 col-sm-4">
                        <a href="#" class="Top-ranking-link d-block">
                            <div class="card text-bg-dark position-relative border-0">
                                <img src="https://cdn.oneesports.vn/cdn-data/sites/4/2023/03/SoloLeveling_Anime_Jinwoo_dagger-1536x864-_1_.jpg" class="card-img opacity-50" alt="...">
                                <div class="card-img-overlay d-flex justify-content-between align-items-center flex-column">
                                    <img src="https://1k-cdn.com/resimler/yazarlar/624017_8ef7f_1604587203.jpg" class="rounded-circle h-75 shadow" alt="avatar">
                                    <h6 class="card-title text-shadow">Chu-Gong</h6>
                                </div>
                            </div>
                        </a>
                    </div>
                    <div class="col-md-4 col-sm-4">
                        <a href="#" class="Top-ranking-link d-block">
                            <div class="card text-bg-dark position-relative border-0">
                                <img src="https://cdn.oneesports.vn/cdn-data/sites/4/2023/03/SoloLeveling_Anime_Jinwoo_dagger-1536x864-_1_.jpg" class="card-img opacity-50" alt="...">
                                <div class="card-img-overlay d-flex justify-content-between align-items-center flex-column">
                                    <img src="https://1k-cdn.com/resimler/yazarlar/624017_8ef7f_1604587203.jpg" class="rounded-circle h-75 shadow" alt="avatar">
                                    <h6 class="card-title text-shadow">Chu-Gong</h6>
                                </div>
                            </div>
                        </a>
                    </div>
                    <div class="col-md-4 col-sm-4">
                        <a href="#" class="Top-ranking-link d-block">
                            <div class="card text-bg-dark position-relative border-0">
                                <img src="https://cdn.oneesports.vn/cdn-data/sites/4/2023/03/SoloLeveling_Anime_Jinwoo_dagger-1536x864-_1_.jpg" class="card-img opacity-50" alt="...">
                                <div class="card-img-overlay d-flex justify-content-between align-items-center flex-column">
                                    <img src="https://1k-cdn.com/resimler/yazarlar/624017_8ef7f_1604587203.jpg" class="rounded-circle h-75 shadow" alt="avatar">
                                    <h6 class="card-title text-shadow">Chu-Gong</h6>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 p-0 ">
                <table class="table bg-light table-striped mb-0">
                    <thead>
                        <tr>
                            <th class="text-center">Tin tức</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="p-0"><a href="#" class="d-block w-100 p-2 News-link">Đăng ký convert</a></td>
                        </tr>
                        <tr>
                            <td class="p-0"><a href="#" class="d-block w-100 p-2 News-link">Bảng lương convert</a></td>
                        </tr>
                        <tr>
                            <td class="p-0"><a href="#" class="d-block w-100 p-2 News-link">Kiếm tiền với Tàng Thư Viện</a></td>
                        </tr>
                        <tr>
                            <td class="p-0"><a href="#" class="d-block w-100 p-2 News-link">Các đơn vị tiền tệ</a></td>
                        </tr>
                        <tr>
                            <td class="p-0"><a href="#" class="d-block w-100 p-2 News-link">Các bước trở thành một Converter - Không cần...</a></td>
                        </tr>
                        <tr>
                            <td class="p-0"><a href="#" class="d-block w-100 p-2 News-link">TTV Translate - Ứng dụng convert truyện trên mobile</a></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>
<!-- End slider section -->
<!-- Start content-1 section -->
<section class="p-4" id="Content-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-9 ps-0">
                <h6 class="Bg-primary text-white text-center py-2">Mới cập nhật</h6>
                <div class="container-fluid">
                    <div class="row">

                        @foreach (var itemChapter in ViewBag.ListLastChapters)
                        {
                            foreach (var item in Model)
                            {
                                if (itemChapter.book_id == item.book_id)
                                {
                                    <div class="col-6 col-sm-4 col-md-3 p-0 mb-2 pe-2">
                                        <a href="/Home/Details/@item.book_id" class="Story-link d-block">
                                            <div class="card">
                                                <img src="~/Content/asset/img/@item.cover_image" class="card-img-top" alt="...">
                                                <div class="card-body">
                                                    <h5 class="card-title text-center">@item.title</h5>
                                                    <div class="d-flex justify-content-between align-items-end">
                                                        <p class="card-text mb-0">Chương @itemChapter.chapter_number</p>
                                                        <p class="card-text" style="font-size: .8rem;" data-created-at="@itemChapter.created_at">
                                                            @itemChapter.created_at
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </a>
                                    </div>
                                    <script>
                                        function getTimeSince(dateTime) {
                                            var now = new Date();
                                            var timeDiff = now - dateTime;

                                            // Chuyển đổi thời gian từ milliseconds sang giờ, phút, giây
                                            var seconds = Math.floor(timeDiff / 1000);
                                            var minutes = Math.floor(seconds / 60);
                                            var hours = Math.floor(minutes / 60);
                                            var days = Math.floor(hours / 24);

                                            if (days > 0) {
                                                return days + " ngày trước";
                                            } else if (hours > 0) {
                                                return hours + " giờ trước";
                                            } else if (minutes > 0) {
                                                return minutes + " phút trước";
                                            } else {
                                                return "Vừa mới đăng";
                                            }
                                        }

                                        // Lặp qua tất cả các phần tử và cập nhật thời gian trước đó
                                        var timeElements = document.querySelectorAll("[data-created-at]");
                                        timeElements.forEach(function (element) {
                                            var createdDate = new Date(element.dataset.createdAt);
                                            element.innerText = getTimeSince(createdDate);
                                        });
                                    </script>
                                }
                            }

                        }

                        <div class="row">
                            Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) of @Model.PageCount
                            @Html.PagedListPager(Model, page =>
                            Url.Action("Index", new { page }),
                            new PagedListRenderOptions
                            {
                                LiElementClasses = new[] { "page-item", "page-link", "LiA" },
                                UlElementClasses = new[] { "pagination" },
                                ContainerDivClasses = new[] { "d-flex justify-content-center" }
                            })
                        </div>

                    </div>
                </div>
            </div>
            @{
                Html.RenderPartial("ContentRightView");
            }
        </div>
    </div>
</section>
<style>
    .LiA {
        padding-right: 0;
        padding-left: 0;
    }

        .LiA a {
            padding: 8px 32px;
        }
</style>
<!-- End content-1 section -->